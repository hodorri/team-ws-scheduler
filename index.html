<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Spoqa+Han+Sans+Neo&display=swap" rel="stylesheet">
  <style>
    /* â”€ ê¸°ì¡´ ìŠ¤íƒ€ì¼ â”€ */
    @font-face { font-family: 'OKFont'; src: url('OKFont-Bold.woff') format('woff'); font-weight: 700; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Medium.woff') format('woff'); font-weight: 500; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Light.woff') format('woff'); font-weight: 300; }
    @font-face { font-family: 'OKFont'; src: url('ì˜¤ì¼€ì´ì²´ Medium.ttf') format('truetype'); font-weight: 500; }
    @font-face { font-family: 'OKFont'; src: url('ì˜¤ì¼€ì´ì²´ Light.ttf') format('truetype'); font-weight: 300; }

    body {
      font-family: 'OKFont', sans-serif;
      background-color: #fff8f0;
      color: #333;
      padding: 30px;
    }

    h1 {
      color: rgb(245, 80, 0);
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 36px;
      font-weight: 700;
    }

    label {
      display: block;
      margin: 15px 0 5px;
      font-weight: bold;
    }

    select, input, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 14px;
    }

    .form-section {
      margin-bottom: 20px;
    }

    button {
      background-color: rgb(255, 170, 0);
      border: none;
      color: white;
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
    }

    button:hover {
      background-color: rgb(85, 71, 0);
    }

    /* â”€ ìº˜ë¦°ë” ì¶”ê°€ ìŠ¤íƒ€ì¼ â”€ */
    .calendar-container {
      margin: 20px 0;
      border: 1px solid #ccc;
      border-radius: 8px;
      overflow: hidden;
    }
    .calendar-header {
      background: rgb(85,71,0);
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 16px;
    }
    .month-title {
      font-size: 18px;
      font-weight: bold;
    }
    .legend .dot {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin: 0 4px 0 12px;
    }
    .legend .available { background: #F55000; }
    .legend .disabled  { background: #ccc; }

    .calendar-weekdays {
      display: grid;
      grid-template-columns: repeat(7,1fr);
      background: #f0f0f0;
      text-align: center;
    }
    .calendar-weekdays div {
      padding: 6px 0;
      font-weight: 500;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7,1fr);
    }
    .calendar-day {
      border-top: 1px solid #ddd;
      border-right: 1px solid #ddd;
      min-height: 100px;
      padding: 4px;
      font-size: 12px;
    }
    .calendar-day.disabled {
      background: #fafafa;
      color: #ccc;
    }
    .calendar-day .date-num {
      font-weight: bold;
    }
    .time-slots {
      margin-top: 6px;
    }
    .time-slot {
      display: inline-block;
      margin: 2px;
      padding: 4px 6px;
      font-size: 11px;
      border: 1px solid #aaa;
      border-radius: 4px;
      cursor: pointer;
    }
    .time-slot.disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    .time-slot.selected {
      background: #F55000;
      color: white;
      border-color: #F55000;
    }
  </style>
</head>
<body>

  <h1>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬ğŸ•</h1>
  <p style="font-size:12px;line-height:1.6;font-weight:300;">
    ì‹ ì„ ë¦¬ë” ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì„¸ìš”?<br>
    ì„±ê³µì ì¸ ì‹ ì„ ë¦¬ë”ë¡œì„œì˜ ì²´í¬ì¸ì„ ì™„ë£Œí•˜ì‹  ê²ƒì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤ğŸ‰<br><br>
    ë‹¤ìŒ ê³¼ì •ì€ ì‹ ì„ ë¦¬ë” ë¶€ì„ ì´í›„ íŒ€ì˜ ì •ì„œì  ì•ˆì •ê³¼ í˜‘ì—… ê¸°ë°˜ í˜•ì„±ì„ ì§€ì›í•˜ê¸° ìœ„í•œ<br>
    íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ í”„ë¡œê·¸ë¨ìœ¼ë¡œ êµ¬ì„±ì›ë“¤ê³¼ í•¨ê»˜ íŒ€ì˜ í˜„ì¬ë¥¼ ì§„ë‹¨í•˜ê³  ì¼í•˜ëŠ” ë°©ì‹ê³¼ ê´€ê³„ë¥¼ ì¬ì •ë ¬í•˜ëŠ” ì‹œê°„ì„ ê°€ì§ˆ ì˜ˆì •ì…ë‹ˆë‹¤.<br><br>
    5/19(ì›”)~5/30(ê¸ˆ) ì¤‘ ì°¸ì—¬ ê°€ëŠ¥í•œ ì¼ì •ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!<br>
    í•´ë‹¹ ê³¼ì •ì€ íŒ€ë³„ ë§ì¶¤í˜• ê³¼ì •(3ì‹œê°„)ìœ¼ë¡œì„œ ìµœëŒ€í•œ ì„ íƒí•´ì£¼ì‹  ì¼ì •ì— ë§ì¶”ì–´ ê·¼ë¬´ì§€ ì¸ê·¼ì—ì„œ êµìœ¡ ì§„í–‰ ì˜ˆì •ì…ë‹ˆë‹¤.<br>
    ğŸ§©í”„ë¡œê·¸ë¨ ì§„í–‰ ì ˆì°¨<br>
    (1) ê°œë³„ ì§„ë‹¨(ê°ì PC ë˜ëŠ” ëª¨ë°”ì¼ë¡œ ì§„í–‰/5~10ë¶„ ì†Œìš”)<br>
    (2) íŒ€ë³„ ë””í”„ë¦¬í•‘ ì›Œí¬ìˆ ì§„í–‰(3ì‹œê°„)
  </p>

  <form id="scheduleForm">
    <div class="form-section">
      <label for="team" style="font-size:18px;font-weight:500;">íŒ€ ì„ íƒ</label>
      <select id="team" name="team" required>
        <option value="">-- íŒ€ì„ ì„ íƒí•´ì£¼ì„¸ìš” --</option>
        <option>ê²€ì‚¬íŒ€</option>
        <option>ëŒ€ì „ì¤‘ì•™ì§€ì </option>
        <option>ìˆ˜ì‹ íŒ€</option>
        <option>ì•ˆì‚°ì§€ì </option>
        <option>ì—¬ì‹ ê°ë¦¬íŒ€</option>
        <option>í”Œë«í¼ê¸°íšíŒ€</option>
        <option>ë³´ì•ˆê¸°íšíŒ€</option>
        <option>ì¸í”„ë¼ì„œë¹„ìŠ¤1íŒ€</option>
        <option>ì¸ì¬ê°œë°œíŒ€</option>
        <option>ì¬ë¬´íšŒê³„íŒ€</option>
        <option>ì „ëµê¸°íšíŒ€</option>
      </select>
    </div>

    <div class="form-section">
      <label for="datetime" style="font-size:18px;font-weight:500;">íŒ€ ì›Œí¬ìˆ ì¼ì • ì„ íƒ</label>
      <p style="font-size:12px;line-height:1.5;margin-bottom:10px;font-weight:300;">
        5/19(ì›”)~5/30(ê¸ˆ) 09:00~18:00 ì‚¬ì´ 3ì‹œê°„ ë™ì•ˆ ì§„í–‰ ì˜ˆì •(ì ì‹¬ì‹œê°„ 1ì‹œê°„ í¬í•¨ ê°€ëŠ¥)<br>
        íŒ€ ì „ì²´ ì›Œí¬ìˆ ì§„í–‰ì´ ì–´ë ¤ìš´ ê²½ìš° ì¶”ê°€ ì „ë‹¬ ì‚¬í•­ì— ë”°ë¡œ ë§ì”€ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
      </p>

      <!-- ìº˜ë¦°ë” ì»¨í…Œì´ë„ˆ (ì´ê³³ìœ¼ë¡œ ì´ë™) -->
      <div class="calendar-container">
        <div class="calendar-header">
          <span class="month-title">2025ë…„ 5ì›”</span>
          <div class="legend">
            <span class="dot available"></span><span>ì„ íƒ ê°€ëŠ¥</span>
            <span class="dot disabled"></span><span>ì£¼ë§/ë¶ˆê°€</span>
          </div>
        </div>
        <div class="calendar-weekdays">
          <div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>

      <input type="text" id="datetime" name="datetime" required readonly placeholder="ë‚ ì§œì™€ ì‹œì‘ì‹œê°„ì„ ì„ íƒí•˜ì„¸ìš”">
    </div>

    <div class="form-section">
      <label for="name" style="font-size:18px;font-weight:500;">ì°¸ì—¬ íŒ€ì›</label>
      <p style="font-size:12px;line-height:1.5;font-weight:300;">
        ì˜ˆì‹œ: ê¹€ìë§¨ ì°¨ì¥, ì´ìë§¨ ëŒ€ë¦¬, ë°•ìë§¨ ì‚¬ì›
      </p>
      <input type="text" id="name" name="name" placeholder="íŒ€ì›ì˜ ì´ë¦„ê³¼ ì§ê¸‰ì„ ì…ë ¥í•˜ì„¸ìš”" required>
    </div>

    <div class="form-section">
      <label for="note" style="font-size:18px;font-weight:500;">ì¶”ê°€ ì „ë‹¬ ì‚¬í•­</label>
      <textarea id="note" name="note" rows="3" placeholder="íŠ¹ì´ì‚¬í•­ ë˜ëŠ” ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    </div>

    <button type="submit">ì‹ ì²­í•˜ê¸°</button>
  </form>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <!-- ìº˜ë¦°ë” ê·¸ë¦¬ë“œ & 3ì‹œê°„ ì—°ì† ì„ íƒ ë¡œì§ -->
  <script>
  (function(){
    const calendarGrid = document.getElementById('calendarGrid');
    const dateInput    = document.getElementById('datetime');
    let selectedEls    = [];

    // 5/19~5/30 í‰ì¼ë§Œ ì¤€ë¹„
    const days = [];
    for (let d = 19; d <= 30; d++) {
      const date = new Date(2025, 4, d);
      const dow  = date.getDay(); // 0=ì¼, 6=í† 
      days.push({ day: d, disabled: (dow === 0 || dow === 6) });
    }

    const timeSlots = ["09:00","10:00","11:00","12:00","13:00","14:00","15:00"];

    days.forEach(({ day, disabled }) => {
      const cell = document.createElement('div');
      cell.className = 'calendar-day' + (disabled ? ' disabled' : '');

      const num = document.createElement('div');
      num.className = 'date-num';
      num.textContent = day;
      cell.appendChild(num);

      if (!disabled) {
        const wrapper = document.createElement('div');
        wrapper.className = 'time-slots';

        timeSlots.forEach(time => {
          const hour = parseInt(time);
          const isDisabled = hour > 15;
          const btn = document.createElement('span');
          btn.className = 'time-slot' + (isDisabled ? ' disabled' : '');
          btn.textContent = time;

          if (!isDisabled) {
            btn.addEventListener('click', () => {
              // ì´ì „ ì„ íƒ í•´ì œ
              selectedEls.forEach(el => el.classList.remove('selected'));
              selectedEls = [];

              // í´ë¦­ ì‹œ í•´ë‹¹ ì‹œê°ë¶€í„° 3ì‹œê°„ ì—°ì† ì„ íƒ
              const slots = Array.from(wrapper.querySelectorAll('.time-slot'));
              const startIdx = slots.indexOf(btn);
              const toSelect = slots.slice(startIdx, startIdx + 3);
              toSelect.forEach(slot => {
                if (!slot.classList.contains('disabled')) {
                  slot.classList.add('selected');
                  selectedEls.push(slot);
                }
              });

              // inputì— ì‹œì‘ ì‹œê°„ë§Œ ë°˜ì˜
              const mm = String(day).padStart(2, '0');
              dateInput.value = `2025-05-${mm} ${time}`;
            });
          }

          wrapper.appendChild(btn);
        });
        cell.appendChild(wrapper);
      }

      calendarGrid.appendChild(cell);
    });
  })();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
  <script>
    flatpickr("#datetime", {
      locale: 'ko',
      enableTime: true,
      time_24hr: true,
      dateFormat: "Y-m-d H:00",
      minDate: "2025-05-19",
      maxDate: "2025-05-30",
      minuteIncrement: 60,
      disable: [date => date.getDay() === 0 || date.getDay() === 6],
      minTime: "09:00",
      maxTime: "18:00"
    });

    document.getElementById('scheduleForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const form = this;
      const rawDate = document.getElementById('datetime').value;
      const [date, hour] = rawDate.split(' ');
      const startHour = parseInt(hour);
      const endHour = startHour + 3;
      const weekDays = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
      const dateObj = new Date(`${date}T${String(startHour).padStart(2,'0')}:00:00`);
      const dayName = weekDays[dateObj.getDay()];
      const timeRange = `${date}(${dayName}) ${String(startHour).padStart(2,'0')}:00 ~ ${String(endHour).padStart(2,'0')}:00`;

      const formData = new FormData(form);
      formData.set('datetime', timeRange);

      fetch('https://script.google.com/macros/s/AKfycbxQU7azoea3jf7ylpv31Dz3cdvxdidObovxGbp4zIxcuwHVqgDSfE81k2ykHxLfkVIZ/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => response.text())
      .then(result => {
        alert(`ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\nì„ íƒí•˜ì‹  ì‹œê°„: ${timeRange}`);
        form.reset();
      })
      .catch(error => {
        console.error('ì˜¤ë¥˜ ë°œìƒ:', error);
        alert('ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      });
    });
  </script>

  <hr style="margin:40px 0 10px;">
  <div style="font-size:13px;font-weight:300;line-height:1.8;color:#555;">
    êµìœ¡ ê´€ë ¨ ë¬¸ì˜ì‚¬í•­ì€ ì–¸ì œë“ ì§€ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.<br><br>
    <strong>ë‹´ë‹¹ì ì—°ë½ì²˜</strong><br>
    ì¸ì¬ê°œë°œíŒ€ ë°•ì„ ìš° ì‚¬ì›<br>
    T. <a href="tel:0237049732" style="color:#555;text-decoration:none;">02-3704-9732</a><br>
    E. <a href="mailto:okhrd@okfngroup.com" style="color:#555;text-decoration:none;">okhrd@okfngroup.com</a>
  </div>

</body>
</html>
