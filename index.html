<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Spoqa+Han+Sans+Neo&display=swap" rel="stylesheet">
  <style>
    /* í°íŠ¸ ì •ì˜ */
    @font-face { font-family: 'OKFont'; src: url('OKFont-Bold.woff') format('woff'); font-weight: 700; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Medium.woff') format('woff'); font-weight: 500; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Light.woff') format('woff'); font-weight: 300; }
    @font-face { font-family: 'OKFont'; src: url('ì˜¤ì¼€ì´ì²´ Light.ttf') format('truetype'); font-weight: 300; }

    body { font-family: 'OKFont', sans-serif; background-color: #fff8f0; color: #333; padding: 30px; }
    h1 { color: rgb(245,80,0); font-size: 36px; font-weight: 700; margin-bottom: 8px; }
    label { display: block; margin: 15px 0 5px; font-weight: 500; font-size: 18px; }
    select, input, textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; font-family:'OKFont'; font-size:12px; font-weight:300; }
    option { font-family:'OKFont'; font-size:12px; font-weight:300; }
    input::placeholder, textarea::placeholder { color:#aaa; }
    .form-section { margin-bottom:20px; }
    button { background-color:rgb(255,170,0); border:none; color:#fff; padding:12px 20px; font-size:16px; border-radius:10px; cursor:pointer; }
    button:hover { background-color:rgb(85,71,0); }

    /* ìº˜ë¦°ë” */
    .calendar-container { margin:20px 0; border:1px solid #ccc; border-radius:8px; overflow:hidden; }
    .calendar-header { background:rgb(85,71,0); color:#fff; display:flex; justify-content:space-between; align-items:center; padding:10px 16px; }
    .month-title { font-size:18px; font-weight:bold; }
    .legend .dot { display:inline-block; width:10px; height:10px; border-radius:50%; margin:0 4px 0 12px; }
    .legend .available { background:#F55000; }
    .legend .disabled  { background:#ccc; }
    .calendar-weekdays { display:grid; grid-template-columns:repeat(7,1fr); background:#f0f0f0; text-align:center; }
    .calendar-weekdays div { padding:6px 0; font-weight:500; }
    .calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); }
    .calendar-day { border-top:1px solid #ddd; border-right:1px solid #ddd; min-height:100px; padding:4px; }
    .calendar-day.disabled { background:#fafafa; color:#ccc; }
    .date-num { font-size:12px; font-weight:bold; }
    .time-slot { display:inline-block; margin:2px; padding:4px 6px; font-size:11px; border:1px solid #aaa; border-radius:4px; cursor:pointer; }
    .time-slot.disabled { opacity:0.4; cursor:not-allowed; }
    .time-slot.selected { background:#F55000; color:#fff; border-color:#F55000; }

    /* ì˜ˆì•½ í˜„í™© */
    #bookingList { margin:20px 0; }
    .booking-card { background:#fff; border:1px solid #ddd; border-radius:6px; padding:12px; margin-bottom:8px; }
    .booking-header { font-weight:bold; color:#554700; margin-bottom:6px; }
    .booking-info { display:flex; gap:12px; font-size:12px; color:#555; }

    /* ë¬¸ì˜ */
    .contact-info { margin-top:40px; font-size:13px; color:#555; line-height:1.8; }
    .contact-info a { color:#555; text-decoration:none; }
  </style>
</head>
<body>
  <h1>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬ğŸ•</h1>
  <p style="font-size:12px; line-height:1.6; font-weight:300;">ì‹ ì„ ë¦¬ë” ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì„¸ìš”?<br>5/19~5/30 í‰ì¼ 09:00~18:00 ì¤‘ 3ì‹œê°„ ì›Œí¬ìˆì„ ì˜ˆì•½í•˜ì„¸ìš”. ì´ë¯¸ ì˜ˆì•½ëœ ì‹œê°„ëŒ€ëŠ” íšŒìƒ‰ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.</p>

  <form id="scheduleForm">
    <div class="form-section">
      <label for="team">íŒ€ ì„ íƒ</label>
      <select id="team" name="team" required>
        <option value="">-- ì„ íƒ --</option>
        <option>ê²€ì‚¬íŒ€</option><option>ëŒ€ì „ì¤‘ì•™ì§€ì </option><option>ìˆ˜ì‹ íŒ€</option><option>ì•ˆì‚°ì§€ì </option>
        <option>ì—¬ì‹ ê°ë¦¬íŒ€</option><option>í”Œë«í¼ê¸°íšíŒ€</option><option>ë³´ì•ˆê¸°íšíŒ€</option><option>ì¸í”„ë¼ì„œë¹„ìŠ¤1íŒ€</option>
        <option>ì¸ì¬ê°œë°œíŒ€</option><option>ì¬ë¬´íšŒê³„íŒ€</option><option>ì „ëµê¸°íšíŒ€</option>
      </select>
    </div>
    <div class="form-section">
      <label for="datetime">íŒ€ ì›Œí¬ìˆ ì¼ì • ì„ íƒ</label>
      <div class="calendar-container">
        <div class="calendar-header">
          <span class="month-title">2025ë…„ 5ì›”</span>
          <div class="legend"><span class="dot available"></span><span>ì„ íƒ ê°€ëŠ¥</span><span class="dot disabled"></span><span>ë¶ˆê°€</span></div>
        </div>
        <div class="calendar-weekdays"><div>ì¼</div><div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div><div>í† </div></div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>
      <input type="text" id="datetime" name="datetime" readonly placeholder="YYYY-MM-DD HH:00 ~ HH:00" required>
    </div>
    <div class="form-section">
      <label for="name">ì°¸ì—¬ íŒ€ì›</label>
      <input type="text" id="name" name="name" placeholder="ì´ë¦„, ì§ê¸‰" required>
    </div>
    <div class="form-section">
      <label for="note">ì¶”ê°€ ì „ë‹¬ ì‚¬í•­</label>
      <textarea id="note" name="note" rows="3" placeholder="íŠ¹ì´ì‚¬í•­"></textarea>
    </div>
    <button type="submit">ì‹ ì²­í•˜ê¸°</button>
  </form>

  <!-- ì˜ˆì•½ í˜„í™© -->
  <div id="bookingList">
    <h3 class="booking-header">ì˜ˆì•½ í˜„í™©</h3>
    <div id="bookingCards"></div>
  </div>

  <hr style="margin:40px 0; border-top:1px solid #ddd;">
  <div class="contact-info">
    <p>ì¶”ê°€ ë¬¸ì˜ì‚¬í•­ì€ ë‹´ë‹¹ìì—ê²Œ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>
    <p>ì¸ì¬ê°œë°œíŒ€ ë°•ì„ ìš° ì‚¬ì›<br>T. <a href="tel:02-3704-9732">02-3704-9732</a><br>E. <a href="mailto:okhrd@okfngroup.com">okhrd@okfngroup.com</a></p>
  </div>

  <script>
  (async function(){
    // ê³µí†µ ë³€ìˆ˜
    const URL = 'https://script.google.com/macros/s/AKfycbwCYXoZV6Tpv4E8SvHLlDMpvjlHTNDsNiX8AEq2nGJkkRk-QDgZvUCMLT6zKMuJzltX/exec';
    const calendarGrid = document.getElementById('calendarGrid');
    const dateInput = document.getElementById('datetime');
    const cardsContainer = document.getElementById('bookingCards');

    // ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
    async function loadData(){
      try{
        const res = await fetch(URL);
        return await res.json();
      }catch{
        return [];
      }
    }

    // ë Œë”ë§ í•¨ìˆ˜
    async function render(){
      const bookings = await loadData();
      calendarGrid.innerHTML = '';
      cardsContainer.innerHTML = '';

      // ì˜ˆì•½ í˜„í™© ì¹´ë“œ ìƒì„±
      if(bookings.length){
        bookings.sort((a,b)=>a.datetime.localeCompare(b.datetime));
        bookings.forEach(b=>{
          const card = document.createElement('div'); card.className='booking-card';
          card.innerHTML = `<div class="booking-header">${b.team}</div><div class="booking-info"><span>${b.datetime}</span><span>${b.name}</span></div>`;
          cardsContainer.appendChild(card);
        });
      } else {
        cardsContainer.innerHTML = '<p>ì•„ì§ ì˜ˆì•½ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      }

      // ìº˜ë¦°ë” ìƒì„±
      const days = [];
      for(let d=19; d<=30; d++){ const date=new Date(2025,4,d); days.push({day:d,disabled:date.getDay()===0||date.getDay()===6}); }
      const timeSlots = ["09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"];

      days.forEach(({day,disabled})=>{
        const cell = document.createElement('div'); cell.className='calendar-day'+(disabled?' disabled':'');
        const num = document.createElement('div'); num.className='date-num'; num.textContent=day; cell.appendChild(num);
        if(!disabled){
          const wrapper = document.createElement('div'); wrapper.className='time-slots';
          timeSlots.forEach(time=>{
            const booked = bookings.some(b=> b.datetime.startsWith(`2025-05-${String(day).padStart(2,'0')}`) && b.datetime.includes(time));
            const btn = document.createElement('span'); btn.className='time-slot'+(booked?' disabled':''); btn.textContent=time;
            if(!booked && time<='15:00') btn.addEventListener('click', selectSlots);
            wrapper.appendChild(btn);
          });
          cell.appendChild(wrapper);
        }
        calendarGrid.appendChild(cell);
      });
    }

    // ìŠ¬ë¡¯ ì„ íƒ ë¡œì§
    function selectSlots(e){
      const btn = e.currentTarget;
      const wrapper = btn.parentElement;
      const slots = Array.from(wrapper.children);
      const idx = slots.indexOf(btn);
      slots.forEach(s=>s.classList.remove('selected'));
      const toSelect = slots.slice(idx, idx+3);
      toSelect.forEach(s=>s.classList.add('selected'));
      const [dayEl] = wrapper.parentElement.querySelectorAll('.date-num');
      const day = String(dayEl.textContent).padStart(2,'0');
      const start = btn.textContent;
      const end = String(parseInt(start)+3).padStart(2,'0')+':00';
      dateInput.value = `2025-05-${day} ${start} ~ ${end}`;
    }

    // í¼ ì œì¶œ
    document.getElementById('scheduleForm').addEventListener('submit', async function(e){
      e.preventDefault();
      const fd = new FormData(this);
      await fetch(URL, {method:'POST', body:fd});
      this.reset();
      await render();
      alert('ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
    });

    // ì´ˆê¸° ë Œë” + ì£¼ê¸°ì  ì—…ë°ì´íŠ¸
    await render();
    setInterval(render, 30000);

  })();
  </script>
</body>
</html>
