<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Spoqa+Han+Sans+Neo&display=swap" rel="stylesheet">
  <style>
    /* í°íŠ¸ ì •ì˜ */
    @font-face { font-family: 'OKFont'; src: url('OKFont-Bold.woff') format('woff'); font-weight: 700; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Medium.woff') format('woff'); font-weight: 500; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Light.woff') format('woff'); font-weight: 300; }
    @font-face { font-family: 'OKFont'; src: url('ì˜¤ì¼€ì´ì²´ Light.ttf') format('truetype'); font-weight: 300; }

    body { font-family: 'OKFont', sans-serif; background-color: #fff8f0; color: #333; padding: 30px; }
    h1 { font-size: 36px; color: #F55000; margin-bottom: 8px; }
    .form-section label { display: block; margin: 15px 0 5px; font-size: 18px; font-weight: 500; }
    select, input, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font: 300 12px 'OKFont'; }
    input::placeholder, textarea::placeholder { color: #aaa; }
    .form-section { margin-bottom: 20px; }
    button { background: #FFAA00; color: #fff; padding: 12px 20px; font-size: 16px; border: none; border-radius: 10px; cursor: pointer; }
    button:hover { background: #554700; }

    /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
    .calendar-container { margin: 20px 0; border: 1px solid #ccc; border-radius: 8px; overflow: hidden; }
    .calendar-header { background: #554700; color: #fff; padding: 10px; text-align: center; }
    .month-title { font-size: 18px; font-weight: bold; }
    .calendar-weekdays { display: grid; grid-template-columns: repeat(5,1fr); background: #f0f0f0; text-align: center; }
    .calendar-weekdays div { padding: 6px 0; font-weight: 500; }
    .calendar-grid { display: grid; grid-template-columns: repeat(5,1fr); gap: 2px; }
    .calendar-cell { border: 1px solid #ddd; min-height: 100px; padding: 4px; position: relative; }
    .date-num { font-size: 12px; font-weight: bold; position: absolute; top: 4px; left: 4px; }
    .time-slots { margin-top: 24px; display: flex; flex-wrap: wrap; gap: 4px; }
    .time-slot { font-size: 11px; padding: 4px; border: 1px solid #aaa; border-radius: 4px; cursor: pointer; text-align: center; width: calc(20% - 4px); }
    .time-slot.disabled { opacity: 0.4; cursor: not-allowed; }
    .time-slot.selected { background: #F55000; color: #fff; border-color: #F55000; }

    /* ì‹ ì²­ í˜„í™© ìŠ¤íƒ€ì¼ */
    #bookingList { margin: 20px 0; }
    .booking-card { background: #fff; border: 1px solid #ddd; border-radius: 6px; padding: 12px; margin-bottom: 8px; }
    .booking-header { font-weight: bold; color: #554700; margin-bottom: 6px; }
    .booking-info { display: flex; gap: 12px; font-size: 12px; color: #555; }

    /* ë¬¸ì˜ ì—°ë½ì²˜ */
    .contact-info { margin-top: 40px; font-size: 13px; color: #555; line-height: 1.8; }
    .contact-info a { color: #555; text-decoration: none; }
  </style>
</head>
<body>
  <h1>2025ë…„ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ W/S ìŠ¤ì¼€ì¤„ëŸ¬ğŸ•</h1>
  <p style="font:300 13px 'OKFont'; line-height:1.6;">
    ì‹ ì„ ë¦¬ë” ì—¬ëŸ¬ë¶„, ì•ˆë…•í•˜ì„¸ìš”?<br>
    ì„±ê³µì ì¸ ì‹ ì„ ë¦¬ë”ë¡œì„œì˜ ì²´í¬ì¸ì„ ì™„ë£Œí•˜ì‹  ê²ƒì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤ğŸ‰<br><br>
    ë‹¤ìŒ ê³¼ì •ì€ ì‹ ì„ ë¦¬ë” ë¶€ì„ ì´í›„ íŒ€ì˜ ì •ì„œì  ì•ˆì •ê³¼ í˜‘ì—… ê¸°ë°˜ í˜•ì„±ì„ ì§€ì›í•˜ê¸° ìœ„í•œ íŒ€ ë‹¨ìœ„ ì¡°ì§ê°œë°œ í”„ë¡œê·¸ë¨ìœ¼ë¡œ êµ¬ì„±ì›ë“¤ê³¼ í•¨ê»˜ íŒ€ì˜ í˜„ì¬ë¥¼ ì§„ë‹¨í•˜ê³  ì¼í•˜ëŠ” ë°©ì‹ê³¼ ê´€ê³„ë¥¼ ì¬ì •ë ¬í•˜ëŠ” ì‹œê°„ì„ ê°€ì§ˆ ì˜ˆì •ì…ë‹ˆë‹¤.<br><br>
    5/19(ì›”)~5/30(ê¸ˆ) ì¤‘ ì°¸ì—¬ ê°€ëŠ¥í•œ ì¼ì •ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!  
  </p>

  <form id="scheduleForm">
    <div class="form-section">
      <label for="team">íŒ€ ì„ íƒ</label>
      <select id="team" name="team" required>
        <option value="">-- íŒ€ ì„ íƒ --</option>
        <option>ê²€ì‚¬íŒ€</option>
        <option>ëŒ€ì „ì¤‘ì•™ì§€ì </option>
        <option>ìˆ˜ì‹ íŒ€</option>
        <option>ì•ˆì‚°ì§€ì </option>
        <option>ì—¬ì‹ ê°ë¦¬íŒ€</option>
        <option>í”Œë«í¼ê¸°íšíŒ€</option>
        <option>ë³´ì•ˆê¸°íšíŒ€</option>
        <option>ì¸í”„ë¼ì„œë¹„ìŠ¤1íŒ€</option>
        <option>ì¸ì¬ê°œë°œíŒ€</option>
        <option>ì¬ë¬´íšŒê³„íŒ€</option>
        <option>ì „ëµê¸°íšíŒ€</option>
      </select>
    </div>
    <div class="form-section">
      <label for="datetime">íŒ€ ì›Œí¬ìˆ ì¼ì • ì„ íƒ</label>
      <p style="font:300 13px 'OKFont'; line-height:1.4; margin-bottom:10px;">
        ì›Œí¬ìˆì€ íŒ€ë³„ ë§ì¶¤í˜• 3ì‹œê°„ ê³¼ì •ì…ë‹ˆë‹¤.<br>
        3ì‹œê°„ ë‹¨ìœ„ë¡œ ì¼ì •(09:00~18:00)ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.<br><br>
        ì˜ˆì•½ ì¼ì •ì´ ì¤‘ë³µë  ê²½ìš° ì‚¬ì „ ì¡°ìœ¨ì„ ì§„í–‰í•˜ì˜¤ë‚˜<br>
        ì¡°ìœ¨ì´ ì–´ë ¤ìš´ ê²½ìš° ì„ ì°©ìˆœ ê¸°ì¤€ìœ¼ë¡œ ì¼ì •ì´ í™•ì •ë  ìˆ˜ ìˆëŠ” ì  ë¯¸ë¦¬ ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.ğŸ™
      </p>
      <div class="calendar-container">
        <div class="calendar-header">
          <span class="month-title">2025ë…„ 5ì›”</span>
        </div>
        <div class="calendar-weekdays">
          <div>ì›”</div><div>í™”</div><div>ìˆ˜</div><div>ëª©</div><div>ê¸ˆ</div>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>
      <input type="text" id="datetime" name="datetime" readonly placeholder="YYYY-MM-DD HH:00 ~ HH:00" required>
    </div>
    <div class="form-section">
      <label for="name">ì°¸ì—¬ íŒ€ì›</label>
      <p style="font:300 13px 'OKFont'; line-height:1.4; margin-bottom:10px;">
        ë³¸ í”„ë¡œê·¸ë¨ì— ì°¸ì—¬í•  íŒ€ì›ì„ ì ì–´ì£¼ì„¸ìš”.<br>
        ì˜ˆì‹œ: ê¹€ìë§¨ ì°¨ì¥, ì´ìë§¨ ëŒ€ë¦¬, ë°•ìë§¨ ì‚¬ì›
      </p>
      <input type="text" id="name" name="name" placeholder="íŒ€ì›ì˜ ì´ë¦„ê³¼ ì§ê¸‰ì„ ì…ë ¥í•˜ì„¸ìš”(ì‰¼í‘œë¡œ êµ¬ë¶„)" required>
    </div>
    <div class="form-section">
      <label for="note">ì¶”ê°€ ì „ë‹¬ ì‚¬í•­</label>
      <textarea id="note" name="note" rows="3" placeholder="íŠ¹ì´ì‚¬í•­ ë˜ëŠ” ìš”ì²­ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
    </div>
    <button type="submit">ì‹ ì²­í•˜ê¸°</button>
  </form>

  <div id="bookingList">
    <h3 class="booking-header">ì‹ ì²­ í˜„í™©</h3>
    <div id="bookingCards"></div>
  </div>

  <hr style="margin:40px 0; border-top:1px solid #ddd;">
  <div class="contact-info">
    <p>ì¶”ê°€ ë¬¸ì˜ì‚¬í•­ì€ ë‹´ë‹¹ìì—ê²Œ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.</p>
    <p>
      ì¸ì¬ê°œë°œíŒ€ ë°•ì„ ìš° ì‚¬ì›<br>
      T. <a href="tel:02-3704-9732">02-3704-9732</a><br>
      E. <a href="mailto:okhrd@okfngroup.com">okhrd@okfngroup.com</a>
    </p>
  </div>

  <script>
  (async () => {
    const URL = 'https://script.google.com/macros/s/AKfycbwCYXoZV6Tpv4E8SvHLlDMpvjlHTNDsNiX8AEq2nGJkkRk-QDgZvUCMLT6zKMuJzltX/exec';
    const calendarGrid = document.getElementById('calendarGrid');
    const dateInput    = document.getElementById('datetime');
    const cardsContainer = document.getElementById('bookingCards');

    // ì‹ ì²­ í˜„í™© ë¡œë“œ ë° ë Œë”
    async function renderBookings() {
      const bookings = await (async () => {
        try { const res = await fetch(URL); return await res.json(); }
        catch { return []; }
      })();
      cardsContainer.innerHTML = '';
      if (bookings.length) {
        bookings.sort((a,b)=>a.datetime.localeCompare(b.datetime));
        bookings.forEach(b => {
          const card = document.createElement('div'); card.className = 'booking-card';
          card.innerHTML = `<div class="booking-header">${b.team}</div><div class="booking-info"><span>${b.datetime}</span><span>${b.name}</span></div>`;
          cardsContainer.appendChild(card);
        });
      } else {
        cardsContainer.innerHTML = '<p>ì•„ì§ ì‹ ì²­ëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }

    // ìº˜ë¦°ë” ë Œë”
    function renderCalendar() {
      calendarGrid.innerHTML = '';
      const timeSlots = ['09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00'];
      for (let d = 19; d <= 30; d++) {
        const date = new Date(2025,4,d);
        const dow = date.getDay();
        if (dow === 0 || dow === 6) continue;
        const cell = document.createElement('div'); cell.className = 'calendar-cell';
        const num = document.createElement('div'); num.className = 'date-num'; num.textContent = d; cell.appendChild(num);
        const wrap = document.createElement('div'); wrap.className = 'time-slots';
        timeSlots.forEach(t => {
          const btn = document.createElement('span'); btn.className = 'time-slot'; btn.textContent = t;
          if (t <= '15:00') {
            btn.addEventListener('click', () => {
              // ì „ì²´ ì„ íƒ í•´ì œ
              document.querySelectorAll('.time-slot.selected').forEach(s => s.classList.remove('selected'));
              // ì´ ë¼ì¸ì—ì„œ ì„ íƒ
              const slots = Array.from(wrap.children);
              const idx = slots.indexOf(btn);
              slots.slice(idx, idx+3).forEach(s => s.classList.add('selected'));
              const start = btn.textContent;
              const end = String(parseInt(start)+3).padStart(2,'0') + ':00';
              dateInput.value = `2025-05-${String(d).padStart(2,'0')} ${start} ~ ${end}`;
            });
          } else {
            btn.classList.add('disabled');
          }
          wrap.appendChild(btn);
        });
        cell.appendChild(wrap);
        calendarGrid.appendChild(cell);
      }
    }

    document.getElementById('scheduleForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      await fetch(URL, { method: 'POST', body: new FormData(this) });
      this.reset();
      await renderBookings();
      alert('ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ğŸ™Œ');
    });

    // ì´ˆê¸° ë Œë” + ì£¼ê¸° ê°±ì‹ 
    renderCalendar();
    await renderBookings();
    setInterval(renderBookings, 30000);
  })();
  </script>
</body>
</html>
