<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>2025년 팀 단위 조직개발 W/S 스케줄러</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Spoqa+Han+Sans+Neo&display=swap" rel="stylesheet">
  <style>
    /* 폰트 정의 */
    @font-face { font-family: 'OKFont'; src: url('OKFont-Bold.woff') format('woff'); font-weight: 700; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Medium.woff') format('woff'); font-weight: 500; }
    @font-face { font-family: 'OKFont'; src: url('OKFont-Light.woff') format('woff'); font-weight: 300; }
    @font-face { font-family: 'OKFont'; src: url('오케이체 Light.ttf') format('truetype'); font-weight: 300; }

    body { font-family: 'OKFont', sans-serif; background: #fff8f0; color: #333; padding: 30px; }
    h1 { font-size:36px; color:#F55000; margin-bottom:8px; }
    label { display:block; margin:15px 0 5px; font-size:18px; font-weight:500; }
    select,input,textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:8px; font:300 12px 'OKFont'; }
    input::placeholder,textarea::placeholder { color:#aaa; }
    .form-section { margin-bottom:20px; }
    button { background:#FFAA00; color:#fff; padding:12px 20px; font-size:16px; border:none; border-radius:10px; cursor:pointer; }
    button:hover { background:#554700; }

    /* 캘린더 스타일 */
    .calendar-container { margin:20px 0; border:1px solid #ccc; border-radius:8px; overflow:hidden; }
    .calendar-header { background:#554700; color:#fff; padding:10px; display:flex; justify-content:space-between; align-items:center; }
    .month-title { font-size:18px; font-weight:bold; }
    .legend .dot { display:inline-block; width:10px; height:10px; border-radius:50%; margin:0 4px; }
    .legend .available { background:#F55000; }
    .legend .disabled  { background:#ccc; }
    .calendar-weekdays { display:grid; grid-template-columns:repeat(7,1fr); background:#f0f0f0; text-align:center; }
    .calendar-weekdays div { padding:6px 0; font-weight:500; }
    .calendar-grid { display:grid; grid-template-columns:repeat(7,1fr); }
    .calendar-cell { border:1px solid #ddd; min-height:80px; padding:4px; position:relative; }
    .calendar-cell.blank { background:#fafafa; }
    .date-num { font-size:12px; font-weight:bold; position:absolute; top:4px; right:4px; }
    .time-slots { margin-top:20px; display:flex; flex-wrap:wrap; gap:2px; }
    .time-slot { font-size:11px; padding:2px 4px; border:1px solid #aaa; border-radius:4px; cursor:pointer; }
    .time-slot.disabled { opacity:0.4; cursor:not-allowed; }
    .time-slot.selected { background:#F55000; color:#fff; border-color:#F55000; }

    /* 예약 현황 스타일 */
    #bookingList { margin:20px 0; }
    .booking-card { background:#fff; border:1px solid #ddd; border-radius:6px; padding:12px; margin-bottom:8px; }
    .booking-header { font-weight:bold; color:#554700; margin-bottom:6px; }
    .booking-info { display:flex; gap:12px; font-size:12px; color:#555; }

    /* 문의 */
    .contact-info { margin-top:40px; font-size:13px; color:#555; line-height:1.8; }
    .contact-info a { color:#555; text-decoration:none; }
  </style>
</head>
<body>
  <h1>2025년 팀 단위 조직개발 W/S 스케줄러🕐</h1>
  <p style="font:300 12px 'OKFont';">5/19(월)~5/30(금) 09:00~18:00 중 3시간 워크숍을 예약하세요. 이미 예약된 블록은 선택 불가로 표시됩니다.</p>

  <form id="scheduleForm">
    <div class="form-section">
      <label for="team">팀 선택</label>
      <select id="team" name="team" required>
        <option value="">-- 팀 선택 --</option>
        <option>검사팀</option><option>대전중앙지점</option><option>수신팀</option><option>안산지점</option>
        <option>여신감리팀</option><option>플랫폼기획팀</option><option>보안기획팀</option><option>인프라서비스1팀</option>
        <option>인재개발팀</option><option>재무회계팀</option><option>전략기획팀</option>
      </select>
    </div>
    <div class="form-section">
      <label>팀 워크숍 일정 선택</label>
      <div class="calendar-container">
        <div class="calendar-header">
          <span class="month-title">2025년 5월</span>
          <div class="legend"><span class="dot available"></span>선택 가능<span class="dot disabled"></span>불가</div>
        </div>
        <div class="calendar-weekdays">
          <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>
      <input type="text" id="datetime" name="datetime" readonly placeholder="YYYY-MM-DD HH:00 ~ HH:00" required>
    </div>
    <div class="form-section">
      <label for="name">참여 팀원</label>
      <input type="text" id="name" name="name" placeholder="이름, 직급" required>
    </div>
    <div class="form-section">
      <label for="note">추가 전달 사항</label>
      <textarea id="note" name="note" rows="3" placeholder="특이사항"></textarea>
    </div>
    <button type="submit">신청하기</button>
  </form>

  <div id="bookingList"><h3 class="booking-header">예약 현황</h3><div id="bookingCards"></div></div>

  <hr style="margin:40px 0; border-top:1px solid #ddd;">
  <div class="contact-info">
    <p>추가 문의사항은 담당자에게 연락 부탁드립니다.</p>
    <p>인재개발팀 박선우 사원<br>T. <a href="tel:02-3704-9732">02-3704-9732</a><br>E. <a href="mailto:okhrd@okfngroup.com">okhrd@okfngroup.com</a></p>
  </div>

  <script>
  (async()=>{
    const URL='https://script.google.com/macros/s/AKfycbwCYXoZV6Tpv4E8SvHLlDMpvjlHTNDsNiX8AEq2nGJkkRk-QDgZvUCMLT6zKMuJzltX/exec';
    const grid=document.getElementById('calendarGrid');
    const input=document.getElementById('datetime');
    const cards=document.getElementById('bookingCards');

    async function load(){ try{const r=await fetch(URL);return await r.json();}catch{return [];} }

    async function render(){
      const data=await load();
      // 예약 현황 카드
      cards.innerHTML='';
      if(data.length){data.sort((a,b)=>a.datetime.localeCompare(b.datetime));
        data.forEach(b=>{const c=document.createElement('div');c.className='booking-card';c.innerHTML=`<div class="booking-header">${b.team}</div><div class="booking-info"><span>${b.datetime}</span><span>${b.name}</span></div>`;cards.appendChild(c);});
      } else cards.innerHTML='<p>아직 예약된 일정이 없습니다.</p>';

      // 캘린더
      grid.innerHTML='';
      const first=new Date(2025,4,1).getDay();
      const daysInMonth=30;
      // 빈 칸
      for(let i=0;i<first;i++){const c=document.createElement('div');c.className='calendar-cell blank';grid.appendChild(c);}      
      // 날짜 셀
      for(let d=1;d<=daysInMonth;d++){
        const date=new Date(2025,4,d),cell=document.createElement('div');cell.className='calendar-cell';
        if(date.getDay()===0||date.getDay()===6||d<19)cell.classList.add('disabled');
        const num=document.createElement('div');num.className='date-num';num.textContent=d;cell.appendChild(num);
        if(!(cell.classList.contains('disabled'))){
          const wrap=document.createElement('div');wrap.className='time-slots';
          ['09:00','10:00','11:00','12:00','13:00','14:00','15:00'].forEach(t=>{
            const btn=document.createElement('span');btn.className='time-slot';btn.textContent=t;
            // 예약 블록 체크
            const blk=data.some(b=>{const [ds,_,rng]=b.datetime.split(' ');if(!ds.endsWith(String(d).padStart(2,'0')))return false;const [st,,et]=rng.split(' ');const sh=parseInt(st), eh=parseInt(et);const th=parseInt(t);return th>=sh&&th<eh;});
            if(blk)btn.classList.add('disabled');
            else btn.addEventListener('click',()=>{
              wrap.querySelectorAll('.time-slot').forEach(s=>s.classList.remove('selected'));
              const slots=Array.from(wrap.children),idx=slots.indexOf(btn),sel=slots.slice(idx,idx+3);
              sel.forEach(s=>s.classList.add('selected'));
              const start=btn.textContent,end=String(parseInt(start)+3).padStart(2,'0')+':00';
              input.value=`2025-05-${String(d).padStart(2,'0')} ${start} ~ ${end}`;
            });
            wrap.appendChild(btn);
          });
          cell.appendChild(wrap);
        }
        grid.appendChild(cell);
      }
    }

    document.getElementById('scheduleForm').addEventListener('submit',async function(e){e.preventDefault();await fetch(URL,{method:'POST',body:new FormData(this)});this.reset();await render();alert('신청 완료');});
    await render();setInterval(render,30000);
  })();
  </script>
</body>
</html>
